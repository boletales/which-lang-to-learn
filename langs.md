# æ–°å…¥ç”Ÿã®ãŸã‚ã®ã€Œçµå±€ä¿ºã¯ä½•ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚’å­¦ã¹ã°ã„ã„ã‚“ã ã€
ã“ã®è¨˜äº‹ã§ã¯ã€ã€Œã“ã‚Œã‹ã‚‰ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’å­¦ç¿’ã—ãŸã„ã‘ã©ä½•ã‚’ã‚„ã£ãŸã‚‰ã„ã„ã‹ã‚ã‹ã‚‰ãªã„ã£ï¼ã€ã€Œæ–°ã—ããƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚’å­¦ã³ãŸã„ã®ã§ãŠã™ã™ã‚ã‚’çŸ¥ã‚ŠãŸã„ã£ï¼ã€ã¨ã„ã†ã²ã¨ãŸã¡ã®ãŸã‚ã«ã€å„è¨€èªã®ç‰¹å¾´ã¨(é¡ŒæãŒç°¡å˜ã™ãã¦å„è¨€èªã®å‘³ãŒã—ãªã„)ã‚³ãƒ¼ãƒ‰ã‚µãƒ³ãƒ—ãƒ«ã‚’æ²è¼‰ã—ã¦ã„ã¾ã™ã€‚

- <a href='#anchor0'>ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¿ã®å¼·ã„ã‚„ã¤</a>
  - <a href='#anchor0-0'>Python</a>
  - <a href='#anchor0-1'>Ruby</a>
  - <a href='#anchor0-2'>Julia</a>

- <a href='#anchor1'>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ä½¿ã†ã‚„ã¤</a>
  - <a href='#anchor1-0'>C</a>
  - <a href='#anchor1-1'>C++</a>
  - <a href='#anchor1-2'>Rust</a>
  - <a href='#anchor1-3'>Crystal</a>
  - <a href='#anchor1-4'>Assembly</a>

- <a href='#anchor2'>ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ä¸€å‘³</a>
  - <a href='#anchor2-0'>Java</a>
  - <a href='#anchor2-1'>C#</a>
  - <a href='#anchor2-2'>VB.net</a>

- <a href='#anchor3'>é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«å¯¾ã™ã‚‹ã‚µãƒãƒ¼ãƒˆãŒå¼·ã„ã‚„ã¤</a>
  - <a href='#anchor3-0'>OCaml</a>
  - <a href='#anchor3-1'>Haskell</a>
  - <a href='#anchor3-2'>Lisp</a>

- <a href='#anchor4'>Webå±‹ã•ã‚“å‘ã‘</a>
  - <a href='#anchor4-0'>javascript</a>
  - <a href='#anchor4-1'>PHP</a>
  - <a href='#anchor4-2'>WebAssembly</a>
  - <a href='#anchor4-3'>ä»¥ä¸‹æ˜Ÿã®æ•°ã»ã©ã‚ã‚‹AltJS(JSã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹ä»£æ›¿è¨€èª)ã®ä¸€éƒ¨</a>
  - <a href='#anchor4-4'>Typescript</a>
  - <a href='#anchor4-5'>coffeescript</a>
  - <a href='#anchor4-6'>purescript</a>
  - <a href='#anchor4-7'>scala.js</a>
  - <a href='#anchor4-8'>GHCjs</a>
  - <a href='#anchor4-9'>js_of_ocaml</a>

- <a href='#anchor5'>çµ±è¨ˆã¨ã‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ä½¿ã†ã‚„ã¤</a>
  - <a href='#anchor5-0'>R</a>
  - <a href='#anchor5-1'>MATLAB</a>
  - <a href='#anchor5-2'>Fortran</a>

- <a href='#anchor6'>å®Ÿè¡Œç’°å¢ƒã«ã¤ã„ã¦</a>

- <a href='#anchor7'>é€Ÿåº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆã‚ã‚“ã¾ã‚Šå‚è€ƒã«ãªã‚‰ãªã„ï¼‰</a>

- <a href='#anchor8'>è²¢çŒ®è€…ä¸€è¦§</a>


## <a name='anchor0'></a>ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¿ã®å¼·ã„ã‚„ã¤
### <a name='anchor0-0'></a>Python
- ç†ç³»å¤§å­¦ç”Ÿã®ãƒªãƒ³ã‚¬ãƒ•ãƒ©ãƒ³ã‚«
- ã„ã„ã¨ã“ã‚
  - ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒè±Šå¯Œï¼ˆæ©Ÿæ¢°å­¦ç¿’ã¨ã‹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã¨ã‹ï¼‰
  - ä½¿ã£ã¦ã‚‹äººãŒå¤šã„
  - æ–‡æ³•ãŒç°¡å˜
  - PyPy(é«˜é€Ÿãªå®Ÿè£…)ã¨ã‹Cython(ä¸€éƒ¨ã‚³ãƒ¼ãƒ‰ã‚’Cã«å¤‰æ›ã™ã‚‹ãƒ„ãƒ¼ãƒ«)ã‚’ä½¿ãˆã°äººé“çš„ãªå®Ÿè¡Œæ™‚é–“ã§æ¸ˆã‚€
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ç’°å¢ƒæ§‹ç¯‰ãŒã‚„ã‚„ã“ã—ã„
  - ã¨ã¦ã‚‚ãŠãã„(æœ€é€Ÿçµ„æ¯”20å€ä»¥ä¸Š)
  - ãƒ‡ãƒãƒƒã‚°ãŒã—ã¥ã‚‰ã„
  - ã‚ªãƒ•ã‚µã‚¤ãƒ‰ãƒ«ãƒ¼ãƒ«ã¯ã‚¯ã‚½
- æœ‰ç”¨ãªãƒªã‚½ãƒ¼ã‚¹
  - äº¬å¤§ã®è³‡æ–™(https://repository.kulib.kyoto-u.ac.jp/dspace/bitstream/2433/265459/1/Version2021_10_08_01.pdf)

é«˜é€Ÿãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª(numpyã¨ã‹)ã‚’ä½¿ãˆã°Pythonã‚‰ã—ã‹ã‚‰ã¬é€Ÿåº¦ã‚’å‡ºã›ã‚‹

code:
```py
import math
import numpy as np

print("start")
MAX = 100000000

sieve = np.ones(MAX+1, dtype="bool")

sieve[0] = False
sieve[1] = False

for i in range(2,int(math.sqrt(MAX))):
    if sieve[i]:
        sieve[np.arange(i,MAX//i + 1)*i] = False

nums   = np.arange(0,MAX+1)
primes = nums[sieve[nums]]
print(primes[-1])
print("end")
```

result:
```
$ :
$ time python main_nd.pystart
99999989
end

real	0m1.758s
user	0m1.691s
sys	0m1.087s
```

æ™®é€šã®Pythonã®foræ–‡ã¯é…ã„ãŒã€PyPyã§å®Ÿè¡Œã™ã‚‹ã¨ã ã„ã¶ãƒã‚·ã«ãªã‚‹(ãŸã ã—numpyã¯ä½¿ãˆãªã„)

result:
```
$ :
$ time pypy main.pystart
99999989
end

real	0m4.601s
user	0m4.039s
sys	0m0.525s
```

Cythonã§é‡ã„éƒ¨åˆ†ã‚’Cã«å¤‰æ›ã—ã¦ã‚‚é€Ÿããªã‚‹

code:
```py
import cylib

print("start")
primes = cylib.main()
print(primes[-1])
print("end")
```


code:
```py
cimport numpy as np
import numpy as np
import math
import cython

def main():
    cdef:
        int MAX, TRUE, FALSE, pcount
        int[:] sieve
        int[:] primes
        int i, j

    MAX = 100000000
    TRUE  = 1
    FALSE = 0

    sieve = np.full(MAX+1, TRUE, dtype="int32") 
    
    sieve[0] = FALSE
    sieve[1] = FALSE
    
    for i in range(2,int(math.sqrt(MAX))):
        if sieve[i]:
            for j in range(i*i,MAX+1,i):
                sieve[j] = FALSE
    
    primes = np.zeros(MAX+1, dtype="int32") 
    pcount = 0
    
    for i in range(2,MAX+1):
        if sieve[i]:
            primes[pcount] = i
            pcount += 1
    
    return primes, pcount
```

result:
```
$ python setup.py build_ext --inplace
$ time python cymain.pystart
5761455
end

real	0m3.703s
user	0m3.825s
sys	0m0.951s
```


### <a name='anchor0-1'></a>Ruby
- æ¾æ±Ÿåœ¨ä½ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒãŒä½œã£ãŸè¨€èª
- Cè¨€èªçš„ãªforæ–‡ãŒå­˜åœ¨ã—ãªã„ã®ã§ã€æ–‡å­—åˆ—ã‚„é…åˆ—ã‚„é€£æƒ³é…åˆ—ãªã©ã®æ“ä½œã¯mapã‚„selectãªã©ã®å„ç¨®ãƒ¡ã‚½ãƒƒãƒ‰ã§è¡Œã†æ–‡åŒ–
  - `gets.split.map(&:to_i).sort.first(3).reduce(&:+)`ã¿ãŸã„ã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã¤ãªã’ã¦æ›¸ã„ã¦ã„ãã®ã€æ…£ã‚Œã‚‹ã¨çˆ½å¿«
- ã„ã„ã¨ã“ã‚
  - æ›¸ãã‚„ã™ã„(å€‹äººã®æ„Ÿæƒ³)
  - æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå……å®Ÿã—ã¦ã„ã‚‹
  - ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚è±Šå¯Œ
  - CLIãƒ„ãƒ¼ãƒ«ã‚„Webã‚µãƒ¼ãƒ“ã‚¹ã®ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰(ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰)ã‚’æ›¸ãã®ã«å‘ã„ã¦ã‚‹
  - Ruby on Railsã¨ã„ã†Webã‚¢ãƒ—ãƒªç”¨ã®è¶…æœ‰åãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒã‚ã‚‹(ã„ã‚ã„ã‚æ‚ªãè¨€ã‚ã‚ŒãŒã¡ã ãŒã€ãªã‚“ã ã‹ã‚“ã å¼·åŠ›)
  - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ„ãƒ¼ãƒ«(Bundler)ãŒã¾ã¨ã‚‚
  - ç’°å¢ƒæ§‹ç¯‰ã¯ç‰¹ã«é›£ã—ããªã„
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ã¨ã¦ã‚‚ãŠãã„(ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªã®ä¸­ã§ã¯æ™®é€šãã‚‰ã„ã ãŒã€ãã‚Œã§ã‚‚)
  - æ­£ç›´ã€ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã‚„æ©Ÿæ¢°å­¦ç¿’å‘¨ã‚Šã¯å¼±ã„(ãŠã¨ãªã—ãPythonã¨ã‹ä½¿ã£ãŸæ–¹ãŒã„ã„)
  - å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚„é™çš„ãªå‹ãƒã‚§ãƒƒã‚¯ã¯å­˜åœ¨ã™ã‚‹ãŒã€ã„ã‚ã„ã‚æœªæˆç†Ÿ
- ã©ã†ã—ã¦ã‚‚é€Ÿåº¦ãŒæ¬²ã—ã„äººã€ã‚ã‚‹ã„ã¯é™çš„å‹ä»˜ã‘ã®å®‰å¿ƒæ„ŸãŒæ¬²ã—ã„Rubyæ›¸ãã¯Crystalã‚’æ¤œè¨ã—ã¦ã¿ã‚ˆã†

code:
```rb
puts "start"

MAX = 100000000
sieve = Array.new(MAX + 1, true)
sieve[0] = sieve[1] = false

2.upto(Integer.sqrt(MAX)) do |i|
  (i * i).step(by: i, to: MAX) { |j| sieve[j] = false } if sieve[i]
end

primes = sieve.filter_map.with_index { |v, i| i if v }
puts primes.last, "end"
```

result:
```
$ :
$ time ruby main.rbstart
99999989
end

real	0m20.423s
user	0m20.057s
sys	0m0.209s
```


### <a name='anchor0-2'></a>Julia
- Fortranã¨matlabã¨Pythonã®å¾Œé‡œã‚’ã„ã£ãºã‚“ã«ç‹™ãŠã†ã¨ã—ã¦ã„ã‚‹è¨€èª
- ã„ã„ã¨ã“ã‚
  - æ–‡æ³•ãŒã‚·ãƒ³ãƒ—ãƒ«
  - äº‹å‰ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹å¿…è¦ãŒãªã„ãŒã€JITã®ãŠã‹ã’ã§æ¯”è¼ƒçš„é€Ÿã„ï¼ˆæœ€é€Ÿçµ„ã«ã¯å‹ã¦ãªã„ï¼‰
  - PyCallã§pythonã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä½¿ãˆã‚‹
  - æ•°å¼ãƒ»è¡Œåˆ—ãŒæ‰±ã„ã‚„ã™ã„
  - numpyã‚„matplotlibãŒpythonã‚ˆã‚Šã ã„ã¶ä½¿ã„ã‚„ã™ã„
  - Pythonã¨Cã¨MATLABã®è‰¯ã„ã¨ã“ã‚ã©ã‚Šçš„å­˜åœ¨ by ã‚ãªã°ã™
  - Jupyter notebookã§ä½¿ãˆã‚‹
  - ä¸¦åˆ—åŒ–ã«å¼·ã„
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ã„ã¾ã®ã¨ã“ã‚å…¥é–€å‘ã‘ã®è‰¯æ›¸ã¯ã‚ã¾ã‚Šãªã„
- ç‰¹å¾´
  - 1-indexedã€ç¸¦è¡Œåˆ—åŸºæœ¬ãªã©ç™–ãŒã‚ã‚‹ï¼ˆæ•°å¼ã‚’ãã®ã¾ã¾ä½¿ãˆã‚‹ã‹ã‚‰æ•°å­¦å±‹ã¨ã‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±‹ã«ã¯ä¾¿åˆ©ï¼‰
  - ã‚¯ãƒ©ã‚¹ã¯ãªã„ï¼ˆPythonã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’è„³æ­»ã§ç§»æ¤ã¯ã§ããªã„ï¼‰ï¼ˆæ§‹é€ ä½“ã§ä¼¼ãŸã‚ˆã†ãªã‚‚ã®ã¯ä½œã‚Œã‚‹ï¼‰
  - ã¡ã‚ƒã‚“ã¨è€ƒãˆã¦ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ãªã„ã¨ã„ã¾ã„ã¡é€Ÿåº¦ãŒå‡ºãªã„
- æœ‰ç”¨ãªãƒªã‚½ãƒ¼ã‚¹
  - å…¬å¼wiki

ã‚³ãƒ¼ãƒ‰å…¨ä½“ã‚’é–¢æ•°ã§åŒ…ã¾ãªã„ã¨æ­»ã¬ã»ã©é…ããªã‚‹ã®ã§æ³¨æ„ï¼ˆä¸€æ•—ï¼‰

code:
```jl
function main()
    MAX = 100000000
    
    println("start")
    
    sieve = trues(MAX) :: BitVector
    
    sieve[1] = false
    @inbounds for i :: Int64 in 2:Int64(floor(sqrt(MAX)))
        if sieve[i]
            @inbounds for j in (i*i):i:MAX
                sieve[j] = false
            end
        end
    end

    primes = [i for i in 1:MAX if sieve[i]] :: Vector{Int64}
    
    println(primes[length(primes)])
    println("end")
end
main()
```

result:
```
$ julia main.jl
$ time julia main.jlstart
99999989
end

real	0m0.814s
user	0m0.734s
sys	0m0.072s
```


## <a name='anchor1'></a>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ä½¿ã†ã‚„ã¤
### <a name='anchor1-0'></a>C
- çµ„ã¿è¾¼ã¿ã‚„ã•ã‚“ã®å¿…æºã€ææ€–ã®è‡ªå·±è²¬ä»»ç³»ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª
- ã„ã„ã¨ã“ã‚
  - æœ€é€Ÿçµ„ã€‚ã¨ã«ã‹ãé€Ÿã„
  - ãƒ¡ãƒ¢ãƒªã‚’ç›´æ¥æ‰±ãˆã‚‹
  - ãƒã‚¤ã‚³ãƒ³ã¿ãŸã„ãªåˆ¶é™ã•ã‚ŒãŸç’°å¢ƒä¸‹ã§ã‚‚å‹•ã
  - å‹‰å¼·ã«ã¯ãªã‚‹
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ãƒ¡ãƒ¢ãƒªã‚’ç›´æ¥æ‰±ã‚ã•ã‚Œã‚‹
  - åˆå­¦è€…ã«ã¯é›£ã—ã„
  - ä½•ã‚‚ã‹ã‚‚è‡ªå·±è²¬ä»»

code:
```c
#include <stdio.h>
#include <stdbool.h>
#include <math.h>
#include <string.h>

const int MAX = 100000000;

int main() {
    int SQRT_MAX = (int)sqrt((double)MAX);
    static bool sieve[MAX + 1];
    static int primes[MAX + 1];
    puts("start");
    memset(sieve, 1, (MAX + 1) * sizeof(sieve[0]));
    sieve[0] = false;
    sieve[1] = false;
    for (int i = 0; i <= SQRT_MAX; i++) {
        if (sieve[i]) {
            for (int j = i * i; j <= MAX; j += i) sieve[j] = false;
        }
    }
    int pcount = 0;
    for (int i = 0; i <= MAX; i++) {
        if (sieve[i]) {
            primes[pcount] = i;
            pcount++;
        }
    }

    printf("%d\n", primes[pcount - 1]);
    puts("end");
    return 0;
}
```

result:
```
$ clang   main.c   -O3
$ time ./a.outstart
99999989
end

real	0m0.734s
user	0m0.695s
sys	0m0.030s
```


### <a name='anchor1-1'></a>C++
- è‡ªåˆ†ã®ã“ã¨ã‚’æœ€æ–°é‹­ã ã¨æ€ã£ã¦ã„ã‚‹å¤å‚è¨€èª
- ã„ã„ã¨ã“ã‚
  - æœ€é€Ÿçµ„ã€‚ã¨ã«ã‹ãé€Ÿã„2
  - ãƒ¡ãƒ¢ãƒªã‚’ç›´æ¥æ‰±ãˆã‚‹2
  - ç¾ä»£çš„ãªæ©Ÿèƒ½ãŒãŸãã•ã‚“è¿½åŠ ã•ã‚Œã¦ã„ã‚‹
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ä½•ã‚‚ã‹ã‚‚è‡ªå·±è²¬ä»»
  - åˆå­¦è€…ã«ã¯é›£ã—ã„
- Cã«ãªã„å‹ãŒã„ã£ã±ã„ã‚ã‚‹

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«æœ€é©åŒ–ãƒ•ãƒ©ã‚°ã‚’æ¸¡ã•ãªã„ã¨10å€ä»¥ä¸Šé…ã„(ä¸€æ•—)

code:
```cpp
#include <vector>
#include <iostream>
#include <cmath>

using namespace std;

const int MAX = 100000000;

int main(){
    cout << "start" << endl;
    int SQRT_MAX = (int)sqrt((double)MAX);
    vector<bool> sieve(MAX+1, true);
    sieve[0] = false;
    sieve[1] = false;
    for(auto i=0; i<=SQRT_MAX; i++){
        if(sieve[i]){
            for(auto j = i*i; j<=MAX; j+=i) sieve[j] = false;
        }
    }
    vector<int> primes(MAX+1);
    int pcount = 0;
    for(auto i=0; i<=MAX; i++){
        if(sieve[i]){
            primes[pcount] = i;
            pcount++;
        }
    }

    cout << primes[pcount-1] << endl;
    
    cout << "start" << endl;
    return 0;
}
```

result:
```
$ clang++ main.cpp -O3
$ time ./a.outstart
99999989
start

real	0m0.637s
user	0m0.531s
sys	0m0.093s
```

  
### <a name='anchor1-2'></a>Rust
- ãƒãƒ«ãƒãƒ‘ãƒ©ãƒ€ã‚¤ãƒ è¨€èªç•Œã®æ–°æ˜Ÿ æ–°æ™‚ä»£ã®å‹è€…â€¦â€¦ï¼ï¼Ÿ
- ã„ã„ã¨ã“ã‚
  - æœ€é€Ÿçµ„ã€‚ã¨ã«ã‹ãé€Ÿã„3
  - ãƒ¡ãƒ¢ãƒªã‚’ç›´æ¥æ‰±ãˆã‚‹ãŒã€ç›´æ¥æ‰±ã‚ãšã«æ¸ˆã‚€ï¼ï¼ï¼ã‚³ã‚³é‡è¦ï¼ï¼
  - ãƒ¡ãƒ¢ãƒªå®‰å…¨
  - å‹ã®åŠ›ã§ã‚ˆã‚Šå®‰å…¨ãªã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã‚‹
  - æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«æ–‡å¥ãŒãªã„
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã™ã‚‹äººã«ã‚„ã•ã—ã„ï¼ˆå‹ãƒ¬ãƒ™ãƒ«ã§ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹ï¼‰
  - ä»–ã®è¨€èªã‹ã‚‰å¤§é‡ã«æœ‰ç”¨ãªæ©Ÿèƒ½ã‚’è¼¸å…¥ã—ã¦ã„ã‚‹
  - ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒä¸–è©±ã‚’ç„¼ã„ã¦ãã‚Œã‚‹
  - ãƒã‚¯ãƒ­ãŒåˆ¥è¨€èªã‚’å®Ÿè£…ã§ãã‚‹ãƒ¬ãƒ™ãƒ«ã§è‡ªç”±åº¦é«˜ã„
  - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãŒå„ªç§€
  - ä¸¦åˆ—åŒ–ã«å¼·ã„
  - ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®æ°‘åº¦ãŒé«˜ã„
- ã‚ã‚‹ã„ã¨ã“ã‚
  - é›£æ˜“åº¦ãŒã€é«˜ã„ã€‚ï¼ˆã•ã™ãŒã«ä¸€è¨€èªç›®ã«ã¯ãŠã™ã™ã‚ã§ããªã„ï¼‰
  - ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒå£ã†ã‚‹ã•ã„
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ãªã„äººã«å³ã—ã„
  - ãƒ“ãƒ«ãƒ‰ãŒé…ã„ï¼ˆç‰¹ã«åˆå›ï¼‰
- æœ‰ç”¨ãªãƒªã‚½ãƒ¼ã‚¹
  - The Rust Programming Language (å’Œè¨³): https://doc.rust-jp.rs/book-ja/

code:
```rs
const MAX :usize = 100000000;
fn main() {
    println!("start");

    let mut sieve = vec![true; MAX+1];
    sieve[0] = false;
    sieve[1] = false;
    let sqrtmax = f32::sqrt(MAX as f32) as usize;
    for i in 2..=sqrtmax {
        if sieve[i]{
            for j in i..=MAX/i {
                sieve[j*i] = false;
            }
        }
    }

    let mut primes = vec![0; MAX+1];
    let mut pcount = 0;
    for i in 2..=MAX {
        if sieve[i] {
            primes[pcount] = i;
            pcount += 1;
        }
    }
    println!("{}",primes[pcount-1]);
    println!("end");
}
```

result:
```
$ rustc -O main.rs
$ time ./mainstart
99999989
end

real	0m0.821s
user	0m0.772s
sys	0m0.034s
```


### <a name='anchor1-3'></a>Crystal
- ã„ã„ã¨ã“ã‚
  - æœ€é€Ÿçµ„ã€‚ã¨ã«ã‹ãé€Ÿã„4
  - Rubyã®æ›¸ãã‚„ã™ã•ã¨Cã®é€Ÿåº¦ãŒåˆã‚ã•ã‚Šå®Œç’§ã«è¦‹ãˆã‚‹
  - é™çš„å‹ä»˜ã‘ã€å‹æ¨è«–ãŒå¼·ã„(ã¨ã„ã†ã‹æ˜ç¤ºçš„ã«å‹ã‚’æ›¸ãå¿…è¦ãŒã»ã¼ãªã„)
  - Rubyã®ã„ã„ã¨ã“ã‚ã¯ã ã„ãŸã„å—ã‘ç¶™ã„ã§ã„ã‚‹
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ãƒ“ãƒ«ãƒ‰ãŒé…ã„
  - ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã¾ã ã¾ã å°‘ãªã„
- Rubyé¢¨ã®è¨€èªã§ã¯ã‚ã‚‹ãŒã€æ–‡æ³•ã¯å¤šå°‘é•ã†ã—ã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚‚ãã‚Œãªã‚Šã«å·®ç•°ãŒã‚ã‚‹ã®ã§æ³¨æ„

code:
```cr
puts "start"

MAX = 100000000
sieve = Array.new(MAX + 1, true)
sieve[0] = sieve[1] = false

2.upto(Math.isqrt(MAX)) do |i|
  (i * i).step(by: i, to: MAX) { |j| sieve[j] = false } if sieve[i]
end

primes = (1..MAX).select{ |i| sieve[i] }
puts primes.last, "end"
```

result:
```
$ crystal build --release main.cr
$ time ./mainstart
99999989
end

real	0m0.887s
user	0m0.834s
sys	0m0.046s
```


### <a name='anchor1-4'></a>Assembly
- ã“ã‚Œã©ã†ã‚„ã£ã¦æ›¸ãã‚“ã§ã™ã‹
- ã„ã„ã¨ã“ã‚
  - æœ€é€Ÿçµ„ï¼ˆæ›¸ãäººé–“ã«ã‚ªãƒ—ãƒ†ã‚£ãƒã‚¤ã‚¶ãŒæ­è¼‰ã•ã‚Œã¦ã„ã‚Œã°ï¼‰
  - CPU ã®æ°—æŒã¡ã«ãªã‚Œã‚‹
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ç”Ÿã§æ›¸ãã®ã¯è‹¦è¡Œ
  - ãƒ‡ãƒãƒƒã‚°ã¯ã‚¢ãƒ›ã»ã©å¤§å¤‰
  - ç”Ÿã§æ›¸ãã®ã¯è‹¦è¡Œ
- ã‚¢ãƒ‰ãƒã‚¤ã‚¹
  - `gcc -S main.c` ã‚’ã™ã‚Œã°ã‚¢ã‚»ãƒ³ãƒ–ãƒªãŒè¦‹ã‚Œã‚‹ã®ã§ã€ãã“ã‹ã‚‰ä¿®æ­£ã™ã‚‹ã®ãŒãŠã™ã™ã‚ã€‚
  - [Compiler Explorer](https://gcc.godbolt.org/)ã‚’ä½¿ã†ã®ã‚‚è‰¯ã„ã€‚
  - (C/C++ãªã©ã®) ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ãŸã¾ã«ã„ã„æ„Ÿã˜ã®ã‚³ãƒ¼ãƒ‰ã‚’åã„ã¦ãã‚Œãªã„ã®ã§ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸã‚‚ã®ã‚’è¦‹ã¦ã€é©å®œæ‰‹å‹•ã§ã‚¢ã‚»ãƒ³ãƒ–ãƒªæœ€é©åŒ–ã™ã‚‹ã®ãŒè‰¯ã„ã€‚

code:
```asm
.STR_START:
	.string	"start"
.STR_END:
	.string	"%d\nend\n"
.STR_COUNT:
	.string	"count %d\n\n"

	.globl	main
main:
	# puts("start");
	leaq	.STR_START(%rip), %rdi
	call	puts@PLT

	# sieve[0] = 0b11;
	movb	$3, sieve(%rip)

	# uint i = 1;
	mov 	$1, %esi

	# rdi = sieve;
	leaq	sieve(%rip), %rdi

	# r9d = 1;
	mov 	$1, %r9d


	jmp	.L2
.L3:
	add 	$1, %esi
.L2:
	cmp 	$100000001, %esi
	je	.L19

	# edx = sieve[esi >> 3];
	movl	%esi, %eax
	shrl	$3, %eax
	movzbl	(%rdi, %rax), %edx

	# if(edx & (1 << (si & 7))) continue;
	mov 	%si, %ax
	and 	$7, %al
	bt	 	%ax, %dx
	jc	.L3
	
	# rax = esi * esi // rsi = esi
	mov 	%esi, %eax
	imulq	%rsi, %rax

	# if (rax > 99999999) continue;
	cmp 	$99999999, %eax
	ja	.L3
.L4:
	# edx = eax >> 3;
	movl	%eax, %edx
	shrl	$3, %edx

	# cl = ax & 7;
	mov 	%ax, %cx
	and 	$7, %cl
	
	# eax += esi;
	addl	%esi, %eax

	# r10b = 1 << cl;
	mov 	$1, %r10b
	sal 	%cl, %r10b
	
	# sieve[rdx] |= r10b;
	orb	%r10b, (%rdi,%rdx)

	cmp 	$100000000, %eax
	jbe	.L4
	jmp	.L3



.L19:
	# rcx = primes;
	leaq	primes(%rip), %rcx

	# edx = 0; ebx = -1;
	xorl	%edx, %edx
	movl	$-1, %ebx
.L14:
	# al = eax = *rdi;
	movzbl	(%rdi), %eax

	# if (al & 1) goto L6;
	testb	$1, %al
	jne	.L6

	# ebx = r10d = ebx + 1;
	# primes[r10 = r10d] = edx;
	lea 	1(%ebx), %r10d
	mov 	%r10d, %ebx
	movl	%edx, (%rcx,%r10,4)
.L6:
	# if (al & 2) goto L7;
	testb	$2, %al
	jne	.L7

	# ebx = r10d = ebx + 1;
	# primes[r10 = r10d] = r8d = edx + 1;
	lea 	1(%ebx), %r10d
	lea 	1(%edx), %r8d
	mov 	%r10d, %ebx
	movl	%r8d, (%rcx,%r10,4)
.L7:
	testb	$4, %al
	jne	.L8
	
	# ebx = r10d = ebx + 1;
	# primes[r10 = r10d] = r8d = edx + 2;
	lea 	1(%ebx), %r10d
	lea 	2(%edx), %r8d
	mov 	%r10d, %ebx
	movl	%r8d, (%rcx,%r10,4)
.L8:
	testb	$8, %al
	jne	.L9
	
	# ebx = r10d = ebx + 1;
	# primes[r10 = r10d] = r8d = edx + 3;
	lea 	1(%ebx), %r10d
	lea 	3(%edx), %r8d
	mov 	%r10d, %ebx
	movl	%r8d, (%rcx,%r10,4)
.L9:
	testb	$16, %al
	jne	.L10
	
	# ebx = r10d = ebx + 1;
	# primes[r10 = r10d] = r8d = edx + 4;
	lea 	1(%ebx), %r10d
	lea 	4(%edx), %r8d
	mov 	%r10d, %ebx
	movl	%r8d, (%rcx,%r10,4)
.L10:
	testb	$32, %al
	jne	.L11
	
	# ebx = r10d = ebx + 1;
	# primes[r10 = r10d] = r8d = edx + 5;
	lea 	1(%ebx), %r10d
	lea 	5(%edx), %r8d
	mov 	%r10d, %ebx
	movl	%r8d, (%rcx,%r10,4)
.L11:
	testb	$64, %al
	jne	.L12
	
	# ebx = r10d = ebx + 1;
	# primes[r10 = r10d] = r8d = edx + 6;
	lea 	1(%ebx), %r10d
	lea 	6(%edx), %r8d
	mov 	%r10d, %ebx
	movl	%r8d, (%rcx,%r10,4)
.L12:
	testb	%al, %al
	js	.L13
	
	# ebx = r10d = ebx + 1;
	# primes[r10 = r10d] = r8d = edx + 7;
	lea 	1(%ebx), %r10d
	lea 	7(%edx), %r8d
	mov 	%r10d, %ebx
	movl	%r8d, (%rcx,%r10,4)
.L13:
	# ++rdi; // ++sieve;
	addq	$1, %rdi

	# edx += 8;
	addl	$8, %edx
	cmpl	$100000000, %edx
	jne	.L14


	# eax = ebx;
	movl	%ebx, %eax

	# edx = primes[rax = eax];
	movl	(%rcx,%rax,4), %edx
	# rsi = STR_END;
	leaq	.STR_END(%rip), %rsi
	# printf
	xorl	%eax, %eax
	call	__printf_chk@PLT

	# printf(STR_COUNT)
	leaq	.STR_COUNT(%rip), %rsi
	movl	%ebx, %edx
	xorl	%eax, %eax
	call	__printf_chk@PLT

	# return 0;
	xorl	%eax, %eax
	ret

	.bss
primes:
	.zero	400000004
sieve:
	.zero	100000001
```

result:
```
$ gcc main.s
$ time ./a.outstart
99999989
end
count 5717621


real	0m0.643s
user	0m0.637s
sys	0m0.003s
```


## <a name='anchor2'></a>ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ä¸€å‘³

### <a name='anchor2-0'></a>Java
- ã„ã„ã¨ã“ã‚
  - ã‚³ãƒ¼ãƒ‰ã®è¦æ¨¡ãŒå¤§ãããªã‚‹ã“ã¨ã«å¤§ã—ã¦è€æ€§ãŒå¼·ã„
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ã‚³ãƒ¼ãƒ‰ãŒå†—é•·
- ç‰¹å¾´
  - æ¥­å‹™ã§ä½¿ã‚ã‚ŒãŒã¡
  - ã‚¶ãƒ»ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘

code:
```java
import java.util.Arrays;
class Primes {
    public static void main(String[] args){
        System.out.println("start");
        final int max = 100000000;
        boolean[] sieve = new boolean[max+1];
        Arrays.fill(sieve, true);
        var sqrtmax = (int)Math.sqrt(max);
        for(var i = 2; i <= sqrtmax; i++){
            if(sieve[i]){
              for(var j = i*i; j <= max; j+=i){
                    sieve[j] = false;
              }
            }
        }
        var primes = new int[max + 1];
        var pcount = 0;
        for(var i = 2; i <= max; i++){
            if(sieve[i]){
                primes[pcount] = i;
                pcount += 1;
            }
        }
        System.out.println(primes[pcount-1]);
        
        System.out.println("end");
    }
}
```

result:
```
$ javac main.java
$ time java Primesstart
99999989
end

real	0m0.973s
user	0m0.841s
sys	0m0.141s
```

### <a name='anchor2-1'></a>C#
- MSè£½ã®Javaã®ã‚ˆã†ãªãªã«ã‹
- ã„ã„ã¨ã“ã‚
  - ã‚³ãƒ¼ãƒ‰ã®è¦æ¨¡ãŒå¤§ãããªã‚‹ã“ã¨ã«å¤§ã—ã¦è€æ€§ãŒå¼·ã„2
  - Winå‘ã‘ã®GUIã‚¢ãƒ—ãƒªã‚’æ›¸ãã®ãŒç°¡å˜
  - Unityã§ä½¿ã†ã‚‰ã—ã„
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ã‚³ãƒ¼ãƒ‰ãŒå†—é•·2(Javaã‚ˆã‚Šã‚„ã‚„ãƒã‚·ã‹ã‚‚)

code:
```cs
ï»¿// See https://aka.ms/new-console-template for more information
Console.WriteLine("start");
const int max = 100000000;
bool[] sieve = Enumerable.Repeat(true, max + 1).ToArray();
var sqrtmax = (int)Math.Sqrt(max);
for(var i = 2; i <= sqrtmax; i++){
    if(sieve[i]){
      for(var j = i*i; j <= max; j+=i){
            sieve[j] = false;
      }
    }
}
var primes = new int[max + 1];
var pcount = 0;
for(var i = 2; i <= max; i++){
    if(sieve[i]){
        primes[pcount] = i;
        pcount += 1;
    }
}

Console.WriteLine(primes[pcount - 1]);
Console.WriteLine("end");
```

result:
```
$ dotnet publish -c release -r linux-x64
$ time ./bin/release/net6.0/linux-x64/csstart
99999989
end

real	0m0.859s
user	0m0.773s
sys	0m0.044s
```

### <a name='anchor2-2'></a>VB.net
- C#(VisualBasicé¢¨å‘³)
- ã„ã„ã¨ã“ã‚
  - æ–‡æ³•ãŒåˆå­¦è€…ã«ã‚‚ã‚ã‹ã‚Šã‚„ã™ã„(Basicã®è¡€ã‚’å¼•ã„ã¦ã„ã‚‹ã ã‘ã‚ã‚‹)
  - C#ã¨ã®ç›¸äº’é‹ç”¨ãŒå®¹æ˜“ã€‚ã‚ã£ã¡ã‚ƒå®¹æ˜“ã€‚
  - Winå‘ã‘ã®GUIã‚¢ãƒ—ãƒªã‚’æ›¸ãã®ãŒç°¡å˜2
  - ã‚³ãƒ¼ãƒ‰ã®è¦æ¨¡ãŒå¤§ãããªã‚‹ã“ã¨ã«å¤§ã—ã¦è€æ€§ãŒå¼·ã„3
  - C#
- ã‚ã‚‹ã„ã¨ã“ã‚
  - Windowsä»¥å¤–ã§ã®ä½¿ã„ã¿ã¡ãŒã‚ã¾ã‚Šãªã„
  - æ§‹æ–‡ãŒå†—é•·ãªã®ã§è£œå®ŒãŒãªã„ã¨ã¤ã‚‰ã„(VisualStudioã§æ›¸ãåˆ†ã«ã¯è£œå®ŒãŒå¼·ã„ã®ã§æ°—ã«ãªã‚‰ãªã„)
  - ä¸é‡
  - C#

code:
```vb
Imports System

Module Program
    Sub Main(args As String())
        Console.WriteLine("start")
        Const max  As Integer = 100000000
        Dim sieve() As Boolean = Enumerable.Repeat(True, max + 1).ToArray()
        Dim sqrtmax As Integer = CType(Math.Sqrt(max), Integer)
        For i As Integer = 2 To sqrtmax
            If sieve(i) Then
                For j As Integer= i * i To max Step i
                    sieve(j) = False
                Next
            End If
        Next
        Dim primes(max + 1) As Integer
        Dim pcount As Integer = 0
        For i As Integer = 2 To max
            If sieve(i) Then
                primes(pcount) = i
                pcount += 1
            End If
        Next
 
        Console.WriteLine(primes(pcount - 1))
 
        Console.WriteLine("end")
    End Sub
End Module
```

result:
```
$ dotnet publish -c release -r linux-x64
$ time ./bin/release/net6.0/linux-x64/vbstart
99999989
end

real	0m0.833s
user	0m0.770s
sys	0m0.043s
```


## <a name='anchor3'></a>é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«å¯¾ã™ã‚‹ã‚µãƒãƒ¼ãƒˆãŒå¼·ã„ã‚„ã¤
### <a name='anchor3-0'></a>OCaml
- å®Ÿç”¨éç´”ç²‹é–¢æ•°å‹è¨€èª
- ã„ã„ã¨ã“ã‚
  - é€Ÿã„
  - å¤‰æ•°ã®å†ä»£å…¥ãŒç¦æ­¢ã•ã‚Œã¦ã„ã‚‹ï¼ˆåŒåå¤‰æ•°ã®å†å®£è¨€ã§è¦‹ãŸç›®å†ä»£å…¥ã£ã½ã„ã“ã¨ã¯ã§ãã‚‹ï¼‰
  - 

é€Ÿã„ã¯ãšã®è¨€èªã§ã‚‚ã‚³ãƒ¼ãƒ‰ãŒã‚ˆã‚ã—ããªã„ã¨é€Ÿåº¦ã‚‚ã‚ˆã‚ã—ããªããªã‚‹ã®ã¯ã‚ˆãã‚ã‚‹è©±ã§ã‚ã‚‹

code:
```ocaml
let main = 
  Printf.printf "start\n";;

  let max = 100000000 in
  let sqrtmax = truncate (sqrt (float_of_int max))
  and sieve = Array.make (max+1) true in

  sieve.(0) <- false;
  sieve.(1) <- false;
  for i = 2 to sqrtmax do
    if sieve.(i) then
      for j = i to Int.div max i do
        sieve.(j*i) <- false;
        ()
      done
    else ()
  done;


  let pcount = ref 0
  and primes = Array.make (max+1) 0 in
  for i = 0 to max do
    if sieve.(i) then begin
      primes.(!pcount) <- i;
      pcount := !pcount+1;
      ()
    end else ()
  done;

  Printf.printf "%d\n" primes.(!pcount - 1);;

  Printf.printf "end\n";;
```

result:
```
$ ocamlopt main.ml -O3
$ time ./a.outstart
99999989
end

real	0m2.097s
user	0m1.748s
sys	0m0.342s
```

### <a name='anchor3-1'></a>Haskell
- ä¸­äºŒç—…æ‚£è€…å‘ã‘ã¸ãæ›²ãŒã‚Šå®Ÿç”¨â€ ç´”ç²‹â€ é–¢æ•°å‹è¨€èª
- ã„ã„ã¨ã“ã‚
  - å‰¯ä½œç”¨ãŒå¸¸ã«æ˜ç¤ºã•ã‚Œã€ç´°ã‹ã„åˆ¶å¾¡ãŒã§ãã‚‹
  - æ–‡æ³•ã¯ä¸€å¿œã‚·ãƒ³ãƒ—ãƒ«
  - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãŒå„ªç§€
  - æ©Ÿæ¢°èªã‹ã‚‰é ãã†ãªã‚ã‚Šã«éæœ€é€Ÿçµ„ã¨åŒç¨‹åº¦ã®é€Ÿåº¦ã§å‹•ã
  - è‡ªå·±æ‹¡å¼µæ€§ãŒé«˜ã„
  - å­¦ã¹ã°å­¦ã¶ã»ã©ç”Ÿç”£æ€§ãŒä¸ŠãŒã‚‹
  - ï¼ˆã™ããªãã¨ã‚‚ä¸–é–“ã®å™‚ã‚ˆã‚Šï¼‰å®Ÿç”¨æ€§ã¯é«˜ã„
  - è¨€èªã‚‚ãƒ„ãƒ¼ãƒ«ã‚‚é€²åŒ–ãŒé€Ÿã„
  - ä¸¦åˆ—åŒ–ã«å¼·ã„
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ä»–ã®è¨€èªã¨è¨­è¨ˆæ€æƒ³ãŒã ã„ã¶é•ã†ã®ã§ã€ãƒãƒ¼ãƒ‰ãƒ«ã¯é«˜ã„
  - è¨€èªã‚‚ãƒ„ãƒ¼ãƒ«ã‚‚é€²åŒ–ãŒé€Ÿã™ãã‚‹
  - åå‰ã ã‘ç‰©ã€…ã—ã„æ¦‚å¿µãŒå¤šã™ãã‚‹
  - ç”Ÿç”£æ€§ã‚’ä¸Šã’ã‚ˆã†ã¨ã™ã‚‹ã¨åº•ãªã—ã®å‹‰å¼·ã‚’å¼·ã„ã‚‰ã‚Œã‚‹
  - ã‚ªãƒ•ã‚µã‚¤ãƒ‰ãƒ«ãƒ¼ãƒ«ã¯ã‚¯ã‚½
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã«ã¯çŸ¥è­˜ã¨åŠªåŠ›ãŒå¿…è¦
  - éå»ã®ã—ãŒã‚‰ã¿ãŒå¤šã„ï¼ˆãƒ„ãƒ¼ãƒ«ã¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨è¨€èªæ‹¡å¼µã®åŠ›ã§æ®´ã£ã¦ãªã‚“ã¨ã‹ã™ã‚‹ï¼‰
  - ãƒ“ãƒ«ãƒ‰ãŒé…ã„ï¼ˆç‰¹ã«åˆå›ï¼‰
- æœ‰ç”¨ãªãƒªã‚½ãƒ¼ã‚¹
  - æ—¥æœ¬Haskellãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚°ãƒ«ãƒ¼ãƒ—: https://haskell.jp/ ã¨ã€ãã“ã®slackï¼ˆåˆå¿ƒè€…ã«ã‚„ã•ã—ã„ï¼‰

æœ€é©åŒ–ã™ã‚‹ã¨ååˆ†é€Ÿã„ãŒã€çŸ¥è­˜ã¨è©¦è¡ŒéŒ¯èª¤ãŒå¿…è¦

code:
```hs
module Main where

import Lib
import qualified Data.Vector.Unboxed as V
import qualified Data.Vector.Unboxed.Mutable as MV
import Data.Foldable
import Control.Monad
import Control.Monad.ST
import Data.STRef
import Control.Loop
import GHC.Float

num :: Int
num = 100000000

main :: IO ()
main = do
  putStrLn "start"
  let ps = generatePrimes num
  print $ V.last ps
  putStrLn "end"

generatePrimes :: Int -> V.Vector Int
generatePrimes max =
  let sieve = runST (do
          msieve <- MV.replicate (max+1) True
          MV.write msieve 0 False
          MV.write msieve 1 False
          
          numLoop 2 (double2Int $ sqrt $ fromIntegral max) $ \i -> do
            isprime <- MV.unsafeRead msieve i
            when isprime (numLoop i (max `div` i) (\j -> MV.unsafeWrite msieve (i*j) False))
          
          V.unsafeFreeze msieve
        )

      primes = runST (do
          mprimes <- MV.unsafeNew (max+1)
            
          pcount <- foldM (\pcount i -> do
            let isprime = V.unsafeIndex sieve i
            if isprime
            then (do
              MV.unsafeWrite mprimes pcount i
              pure (pcount+1)
              )
            else pure pcount
            ) 0 [2..max]
          V.unsafeFreeze $ MV.unsafeSlice 0 pcount mprimes
        )
  --in V.filter (V.unsafeIndex sieve) (V.generate (max+1) id)
  in primes
```

result:
```
$ stack install --local-bin-path ./
$ time ./hs-exestart
99999989
end

real	0m0.820s
user	0m0.744s
sys	0m0.053s
```

### <a name='anchor3-2'></a>Lisp
  - å¤ä»£ã®é–¢æ•°å‹è¨€èª
  - ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆ
  - æ–¹è¨€ãŒå¤šã„
  - ãã‚‚ã„ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼
  - ã‹ã£ã“ã‹ã£ã“ã‹ã£ã“ã‹ã£ã“

## <a name='anchor4'></a>Webå±‹ã•ã‚“å‘ã‘
### <a name='anchor4-0'></a>javascript
- ã‚‚ã†ãœã‚“ã¶ã“ã‚Œã§ã„ã„ã‚„
- ã„ã„ã¨ã“ã‚
  - GUIä½œã‚ŠãŸããªã£ãŸã‚‰HTML+CSS+JSã§ã‚„ã‚‹ã®ãŒä¸€ç•ªã‹ã‚“ãŸã‚“ã‹ã‚‚ã—ã‚Œãªã„
  - ãƒ–ãƒ©ã‚¦ã‚¶ã§ä½¿ãˆã‚‹ï¼ˆéå¸¸ã«é‡è¦ï¼‰ã¨ã„ã†ã‚ˆã‚Šã€ã“ã‚Œã‚’é™¤ãã¨WebAssembryä»¥å¤–ã®é¸æŠè‚¢ãŒå­˜åœ¨ã—ãªã„
  - ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚‚ä½¿ãˆã‚‹
  - "ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªã«ã—ã¦ã¯"ç•°å¸¸ã«é€Ÿã„(éæœ€é€Ÿçµ„ã¨åŒæ ¼)
  - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãŒå„ªç§€
- ã‚ã‚‹ã„ã¨ã“ã‚
  - å‹ãŒãªã„ã€‚å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‰ãªã„
  - éå»ã®ã—ãŒã‚‰ã¿ãŒå¤šã„ï¼ˆãƒã‚·ã«ãªã‚Šã¤ã¤ã‚ã‚‹ï¼‰
  - æ„›ã™ã¹ãã‚«ã‚¹
- æœ‰ç”¨ãªãƒªã‚½ãƒ¼ã‚¹
  - MDNã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«: https://developer.mozilla.org/ja/docs/Web/Tutorials
  - å›°ã£ãŸã‚‰MDN

TypedArrayä½¿ã£ãŸã‚‰æœ€é€Ÿçµ„ã¨å¼µã‚Šåˆãˆã‚‹é€Ÿã•ãŒå‡ºãŸ
æ™®é€šã®é…åˆ—ã‚’ä½¿ã£ãŸã‚‰ãƒ¡ãƒ¢ãƒªç¢ºä¿ãŒã§ããªããªã£ã¦è½ã¡ãŸ

code:
```js
console.log("start");

const max = 100000000;

let sieve = new Int8Array(max+1);
for(let i=2; i<=max; i++) sieve[i] = 1;

for(let i=2; i<=(Math.floor(Math.sqrt(max)) | 0); i++){
    if(sieve[i]){
        for(let j=i*i; j<=max; j+=i) sieve[j] = false;
    }
}

let primes = new Int32Array(max+1);
let pcount = 0;

for(let i=2; i<=max; i++){
    if(sieve[i]){
        primes[pcount] = i;
        pcount++;
    }
}

console.log(primes[pcount-1]);

console.log("end")
```

result:
```
$ :
$ time node main.jsstart
99999989
end

real	0m0.877s
user	0m0.841s
sys	0m0.037s
```


### <a name='anchor4-1'></a>PHP
- Webå±‹ã•ã‚“å°‚ç”¨ã®ã‹ã‚“ãŸã‚“ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰è¨€èª
- ã„ã„ã¨ã“ã‚
  - å‹•çš„ã‚µã‚¤ãƒˆã‚’ä½œã‚ŠãŸã„ãªã‚‰ä¸€ç•ªã‹ã‚“ãŸã‚“
  - HTMLã‚’åŸ‹ã‚è¾¼ã‚€ã ã‘ãªã®ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®çŸ¥è­˜ã—ã‹ãªãã¦ã‚‚ã¨ã£ã¤ãã‚„ã™ã„
  - ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã—ã¦ãã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãŒå¤šã„(ã‚¹ã‚¿ãƒ¼ã‚µãƒ¼ãƒãƒ¼ã¨ã‹ã‚¨ãƒƒã‚¯ã‚¹ã‚µãƒ¼ãƒãƒ¼ã¨ã‹)
- ã‚ã‚‹ã„ã¨ã“ã‚
  - ã‚«ã‚ªã‚¹
{sample:php}

### <a name='anchor4-2'></a>WebAssembly
  - ç›´æ¥ã¯æ›¸ã‹ãªã„
  - ä»–ã®è¨€èª(Rustã¨ã‹C++ã¨ã‹)ã‹ã‚‰WASMã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã§ä½¿ãˆã‚‹

### <a name='anchor4-3'></a>ä»¥ä¸‹æ˜Ÿã®æ•°ã»ã©ã‚ã‚‹AltJS(JSã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹ä»£æ›¿è¨€èª)ã®ä¸€éƒ¨
### <a name='anchor4-4'></a>Typescript
  - AltJSã®ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã€å‹ã®ã‚ã‚‹JS
  - å‹ãŒã‚ã‚‹ï¼ï¼ï¼ã—ã‹ã‚‚å¼·ã„ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ˆã¨ã¦ã‚‚é‡è¦ï¼‰
{sample:ts}
### <a name='anchor4-5'></a>coffeescript
  - Rubyã®ã‚ˆã†ãªãªã«ã‹
{sample:coffee}
### <a name='anchor4-6'></a>purescript
  - AltJSã®ç•°ç«¯å…ã€Haskellã®ç”Ÿãå†™ã—
{sample:purs}
### <a name='anchor4-7'></a>scala.js
  - scalaãŒjsã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹
{result:scjs}
### <a name='anchor4-8'></a>GHCjs
  - HaskellãŒjsã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹
{sample:hsjs}
### <a name='anchor4-9'></a>js_of_ocaml
  - OCamlãŒjsã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹
{sample:jsocaml}
{sample:ocjs}

## <a name='anchor5'></a>çµ±è¨ˆã¨ã‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ä½¿ã†ã‚„ã¤
### <a name='anchor5-0'></a>R
- ã„ã„ã¨ã“ã‚
  - çµ±è¨ˆã«ã‚ã£ã¡ã‚ƒå¼·ã„ã€‚ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã€‚ã©ã†ã›ã‚„ã‚‰ã•ã‚Œã‚‹ï¼ˆæ–‡ç³»å«ã‚€ï¼‰
  - æ¤œå®šãŒã‚³ãƒãƒ³ãƒ‰ä¸€ç™ºã§ã§ãã‚‹
  - å›³ãŒç¶ºéº—ã§ç´°ã‹ãæŒ‡å®šã§ãã‚‹
  - ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ãŒä½¿ã„ã‚„ã™ã„
  - æ©Ÿæ¢°å­¦ç¿’ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¤šã„
  - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãŒå„ªç§€
- ã‚ã‚‹ã„ã¨ã“ã‚
  - è¤‡é›‘ãªã“ã¨ã‚’ã™ã‚‹ã¨é…ã„
  - ã‚«ã‚ªã‚¹

code:
```r
main <- function(){
    print("start")
    
    max <- 100000000
    
    sieve <- rep(TRUE, max)
    
    sieve[1] = FALSE
    
    for(i in 1:floor(sqrt(max))){
        if(sieve[i]){
            #for(j in seq(i*i,max,by=i)) sieve[j] = FALSE
            sieve[(i:(max%/%i))*i] = FALSE
        }
    }
    
    nums   <- 1:max
    primes <- nums[sieve[nums]]
    
    print(primes[length(primes)])
    
    print("end")
}

main()
```

result:
```
$ :
$ time Rscript main.r[1] "start"
[1] 99999989
[1] "end"

real	0m3.341s
user	0m2.555s
sys	0m0.775s
```

### <a name='anchor5-1'></a>MATLAB
- ã„ã„ã¨ã“ã‚
  - æ•°å¼ã¨ã‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¼·ã„
  - ã‚°ãƒ©ãƒ•ã‚£ã‚¯ã‚¹ãŒå¼·ã„
- ã‚ã‚‹ã„ã¨ã“ã‚
  - æœ‰æ–™(æ±å¤§ç”Ÿã¯å¤§å­¦ãŒã‚¢ã‚«ã‚¦ãƒ³ãƒˆãã‚Œã‚‹ã®ã§ä½¿ãˆã‚‹)
  - ãã‚“ãªã«é€Ÿãã¯ãªã„
### <a name='anchor5-2'></a>Fortran
- ã„ã„ã¨ã“ã‚
  - æ•°å€¤è¨ˆç®—ã«å¼·ã„ã€‚ã‚ã£ã¡ã‚ƒå¼·ã„ã€‚
  - é€Ÿã„
  - ä¸¦åˆ—åŒ–ãŒã™ã”ãç°¡å˜ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«2è¡Œä»˜ã‘è¶³ã—ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«æ¸¡ã™ãƒ•ãƒ©ã‚°ã‚’ä¸€å€‹å¢—ã‚„ã™ã ã‘ï¼‰
  - ã‚¹ãƒ‘ã‚³ãƒ³ã§ã‚ˆãä½¿ã‚ã‚Œã¦ã„ã‚‹
- ã‚ã‚‹ã„ã¨ã“ã‚
  - æ–‡æ³•ãŒç‹¬ç‰¹
  - ã•ã™ãŒã«ã¤ãã‚ŠãŒå¤ãã¦ã¤ã‚‰ã„

ãªã«ã‚’é–“é•ãˆãŸã®ã‹å¤§ã—ã¦é€Ÿããªã‚‰ãªã‹ã£ãŸ

code:
```f95
program eratosthenes
    implicit none
    
    integer,parameter :: pmax = 100000000
    integer :: i
    integer :: j
    integer :: pcount = 1
    logical,allocatable,dimension(:) :: sieve
    integer,allocatable,dimension(:) :: primes
    allocate(sieve(pmax))
    sieve=.true.
    allocate(primes(pmax))
    primes=0
   
    print *, "start"
    do i=2 , int(sqrt(real(pmax)))
        if(sieve(i))then
            !$omp parallel do
            do j = i , pmax/i
                sieve(j*i) = .false.
            end do
            !$omp end parallel do
        end if
    end do

    do i=2 , pmax
        if(sieve(i))then
            primes(pcount) = i
            pcount = pcount + 1
        end if
    end do

    print *, primes(pcount-1)

    print *, "end"
end program eratosthenes
```

result:
```
$ gfortran -fopenmp -Ofast main.f95
$ time ./a.out start
    99999989
 end

real	0m0.874s
user	0m9.324s
sys	0m0.215s
```


## <a name='anchor6'></a>å®Ÿè¡Œç’°å¢ƒã«ã¤ã„ã¦
ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œæ™‚é–“ã¯ä»¥ä¸‹ã®ç’°å¢ƒã§è¨ˆæ¸¬ã—ã¾ã—ãŸ
- CPU: Ryzen 7 PRO 4750G
- ãƒ¡ãƒ¢ãƒª: 32GB
- OS: Manjaro Linux

## <a name='anchor7'></a>é€Ÿåº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆã‚ã‚“ã¾ã‚Šå‚è€ƒã«ãªã‚‰ãªã„ï¼‰
ãŠã“ã¨ã‚ã‚Šï¼šä»Šå›é¡Œæã¨ã—ãŸã€Œç´ æ•°ã®è¨ˆç®—ã€ã¯æ¯”è¼ƒçš„å˜ç´”ãªã‚³ãƒ¼ãƒ‰ãªã®ã§ã€ä¸€éƒ¨è¨€èªã‚’é™¤ã„ã¦å®Ÿéš›ä»¥ä¸Šã«ä¼¼ãŸã‚Šã‚ˆã£ãŸã‚Šãªçµæœã«ãªã£ã¦ã„ã¾ã™ã€‚ã©ã¡ã‚‰ã‹ã¨ã„ãˆã°ã€Œã©ã®è¨€èªãŒé€Ÿã„ã‹ã€ã‚ˆã‚Šã€Œã©ã®ã‚µãƒ³ãƒ—ãƒ«ãŒã†ã¾ãæ›¸ã‘ã¦ã„ã‚‹ã‹ã€ã®ã»ã†ãŒã ã„ã¶å½±éŸ¿ãŒå¤§ããã†ã§ã™ã€‚

å®Ÿè¡Œæ™‚é–“ï¼š
| rank | lang | time | ratio | 
| - | - | - | - |
| 1 | Rust-bit | 0.30 sec. |1.00x |
| 2 | C++ | 0.64 sec. |2.14x |
| 3 | Assembly | 0.64 sec. |2.16x |
| 4 | C | 0.73 sec. |2.46x |
| 5 | Julia | 0.81 sec. |2.73x |
| 6 | Haskell | 0.82 sec. |2.75x |
| 7 | Rust | 0.82 sec. |2.76x |
| 8 | VB.net | 0.83 sec. |2.80x |
| 9 | C# | 0.86 sec. |2.88x |
| 10 | Fortran | 0.87 sec. |2.93x |
| 11 | JS | 0.88 sec. |2.94x |
| 12 | Crystal | 0.89 sec. |2.98x |
| 13 | Java | 0.97 sec. |3.27x |
| 14 | Python | 1.76 sec. |5.90x |
| 15 | OCaml | 2.10 sec. |7.04x |
| 16 | F# | 2.40 sec. |8.05x |
| 17 | R | 3.34 sec. |11.21x |
| 18 | Cython | 3.70 sec. |12.43x |
| 19 | PyPy | 4.60 sec. |15.44x |
| 20 | Ruby | 20.42 sec. |68.53x |

CPUæ™‚é–“ï¼š
| rank | lang | time | ratio | 
| - | - | - | - |
| 1 | Rust-bit | 0.28 sec. |1.00x |
| 2 | C++ | 0.53 sec. |1.87x |
| 3 | Assembly | 0.64 sec. |2.24x |
| 4 | C | 0.70 sec. |2.45x |
| 5 | Julia | 0.73 sec. |2.58x |
| 6 | Haskell | 0.74 sec. |2.62x |
| 7 | VB.net | 0.77 sec. |2.71x |
| 8 | Rust | 0.77 sec. |2.72x |
| 9 | C# | 0.77 sec. |2.72x |
| 10 | Crystal | 0.83 sec. |2.94x |
| 11 | JS | 0.84 sec. |2.96x |
| 12 | Java | 0.84 sec. |2.96x |
| 13 | Python | 1.69 sec. |5.95x |
| 14 | OCaml | 1.75 sec. |6.15x |
| 15 | F# | 2.22 sec. |7.80x |
| 16 | R | 2.56 sec. |9.00x |
| 17 | Cython | 3.82 sec. |13.47x |
| 18 | PyPy | 4.04 sec. |14.22x |
| 19 | Fortran | 9.32 sec. |32.83x |
| 20 | Ruby | 20.06 sec. |70.62x |


## <a name='anchor8'></a>è²¢çŒ®è€…ä¸€è¦§
- ãƒ¡ã‚¿ãƒªãƒƒã‚¯ã¯ã‚“ãºã‚“ 
  - èª¬æ˜: C, C++, Rust, Python, Haskell, Fortran, JS, PHP, VB.net, C#, Java
  - ã‚µãƒ³ãƒ—ãƒ«: C, C++, Rust, Python, Haskell, Fortran, JS, R, VB.net, C#, F#, OCaml, Java
  - ä¸€è¨€: Haskellã¯ã„ã„è¨€èªã§ã™ã‚ˆã€ã‚„ã‚Œï¼ãŠå‰ã‚‚è“®æ²¼ã«è½ã¡ã‚ï¼ï¼ï¼
- ã‚ãªã°ã™
  - èª¬æ˜: Julia, Lisp, R, MATLAB, Fortran
  - ã‚µãƒ³ãƒ—ãƒ«: Julia
  - ä¸€è¨€: Juliaæœ€é«˜ï¼Juliaã—ã‹å‹ãŸã‚“ï¼
- ç¶¿è°· é›«
  - ã‚µãƒ³ãƒ—ãƒ«: Fortran
  - ä¸€è¨€: å¤å…¸ã‚’å­¦ã¶ã“ã¨ã¯ç‰©äº‹ã®æ ¹å¹¹ã«è§¦ã‚Œã‚‹ã“ã¨ã§ã‚ã‚Šï¼Œãã“ã‹ã‚‰æ´¾ç”Ÿã—ã¦ã§ããŸã‚‚ã®ã®ç†è§£ãŒæ·±ã¾ã‚Šã¾ã™ï¼å¤å…¸èªã‚’ã‚„ã‚Šã¾ã—ã‚‡ã†ï¼
- TumoiYorozu
  - ã‚µãƒ³ãƒ—ãƒ«: Assembly
  - ä¸€è¨€: ç”Ÿã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªã€ã‚‚ã†æ›¸ã‹ãªã„
- ãµãã¼ã‚“
  - èª¬æ˜: Ruby, Crystal
  - ã‚µãƒ³ãƒ—ãƒ«: Ruby, Crystal
  - ä¸€è¨€: ãªã‚“ã ã‹ã‚“ã Rubyã¯ã„ã„è¨€èªã ã¨æ€ã†ã€‚ã‚³ãƒ¼ãƒ‰ã‚´ãƒ«ãƒ•ã«ã‚‚å‘ã„ã¦ã‚‹ã—ã€‚
- ğŸŒ±ğŸŒ¿â˜˜ï¸ğŸ€
  - èª¬æ˜: Rust
  - ã‚µãƒ³ãƒ—ãƒ«: Rust-bit
  - ä¸€è¨€: Rustã®çœŸä¾¡ã¯Webã‚µãƒ¼ãƒãƒ¼ãªã©ã®ã‚·ãƒ“ã‚¢ãªç”¨é€”ã§åˆã‚ã¦ç™ºæ®ã•ã‚Œã‚‹ï¼
- femshima(Nanigashi)
  - ã‚µãƒ³ãƒ—ãƒ«: C
  - ä¸€è¨€: ã„ã¤ã‹çµ„ã¿è¾¼ã¿ã®asmã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚ŠãŸã„(é¡˜æœ›)
  